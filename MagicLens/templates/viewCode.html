<style type="text/css">

  /*CSS for the lens to be dragged around*/
  /*lens effect is achieved by using the box-shadow CSS property*/
  .lens {
    width: 250px; 
    height: 200px;
    position: absolute;
    z-index: 1002;
    pointer-events: auto;
    /*Multiple box shadows to achieve the glass effect*/
    box-shadow: 0 0 0 7px rgba(255, 255, 255, 0.85), 
                0 0 7px 7px rgba(0, 0, 0, 0.85), 
          inset 0 0 40px 2px rgba(0, 0, 0, 0.85);
    background-color:white;
    opacity:0.8;
  }

  img {
    border:1px solid #021a40;
  }

  body {
    margin-left: 35%;
  }

  p {
    text-align: left;
    margin-left: 50px; 
  }

  h1 {
    margin-left: 125px;
  }

</style>

<body>

  <!-- HTML for the lens to be dragged around -->
  <div id="draggableLens" class="lens"></div>

  <h1>Viewing Underlying Web Page Properties</h1>

  <br>

  <!-- The following images come from  http://www.iawriter.com/-->
  <!-- Dummy text was generated by http://www.lipsum.com/ -->
  <img style="display:inline; float:left" src="http://www.iawriter.com/images/@1x/iphone_feature_06.png" width="200" alt="iPhone keyboard" style="vertical-align: text-middle"/>
  <div style="display:inline; float:left"> 
    <h3><p style="width: 20em">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec a eros nibh, non feugiat purus. Ut lacus erat, semper gravida feugiat ut, mattis.</p></h3>
  </div>

  <br><br><br><br><br><br><br><br>

  <img style="display:inline; float:left" src="http://www.iawriter.com/images/@1x/iphone_feature_08.png" width="200" alt="spell checking"/>
  <div style="display:inline; float:left">
      <h3><p style="width: 20em">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec a eros nibh, non feugiat purus. Ut lacus erat, semper gravida feugiat ut, mattis.</p></h3>
  </div>

  <br><br><br><br><br><br><br><br>

  <img style="display:inline; float:left" src="http://www.iawriter.com/images/@1x/iphone_feature_04.png" width="200" alt="exporting documents"/>
  <div style="display:inline; float:left">
      <h3><p style="width: 20em">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec a eros nibh, non feugiat purus. Ut lacus erat, semper gravida feugiat ut, mattis.</p></h3>
  </div>

  <br><br><br><br><br><br><br><br>

  <img style="display:inline; float:left" src="http://www.iawriter.com/images/@1x/ipad_feature_11.jpg" width="200" alt="text formatting"/>
  <div style="display:inline; float:left">
      <h3><p style="width: 20em">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec a eros nibh, non feugiat purus. Ut lacus erat, semper gravida feugiat ut, mattis.</p></h3>
  </div>

  <br><br><br><br><br><br><br><br>      

  <table border="1">
    <tr>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
    </tr>
    <tr>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
    </tr>
    <tr>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
    </tr>
    <tr>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
    </tr>
    <tr>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
    </tr>
    <tr>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
      <td>Lorem ipsum dolor</td>
    </tr>
  </table>

</body>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>

<script>
  $(document).ready(function(){

    // hide the cursor so that only the lens is seen
    $('body').css({'cursor' : 'none'});

    //code obtained from http://stackoverflow.com/questions/4535888/jquery-text-and-newlines to make newline characters work in the lens
    function htmlForTextWithEmbeddedNewlines(text) {
      var htmls = [];
      var lines = text.split(/\n/);
      for (var i = 0 ; i < lines.length ; i++) {
          htmls.push(
              jQuery(document.createElement('div')).text(lines[i]).html()
          );
      }
      return htmls.join("<br>");
    }


    // make lens disappear on mousedown
    $('.lens').click(function(e){
     $('.lens').hide();
     $('body').css({'cursor' : 'default'});
    })

    //make lens reappear on mouseup
    $('img, p, table').click(function(e){
      $('.lens').show();
      $('body').css({'cursor' : 'none'});
    })

    //get the CSS properties of the image to be displayed in the lens
    $('img').mouseover(function(e) {

      var imgWidth = $(e.target).css('width');
      $('#imgWidth').val(imgWidth);
      var imgHeight = $(e.target).css('height');
      $('#imgHeight').val(imgHeight);
      var imgPosition = $(e.target).position();
      var imgX = imgPosition.left;
      $('#imgX').val(imgX);
      var imgY = Math.round(imgPosition.top);
      $('#imgY').val(imgY);
      var imgZIndex = $(e.target).css('z-index');
      $('#imgZIndex').val(imgZIndex);
      var imgMargin = $(e.target).css('margin');
      $('#imgMargin').val(imgMargin);
      var imgBorder = $(e.target).css('border');
      $('#imgBorder').val(imgBorder);
      var imgAltText = $(e.target).attr('alt');
      $('#imgAltText').val(imgAltText);

      var lensImgText = "Width: " + imgWidth + "\n" + 
                        "Height: " + imgHeight + "\n" + 
                        "X Position: " + imgX + "\n" + 
                        "Y Position: " + imgY + "\n" +
                        "Z Index: " + imgZIndex + "\n" +
                        "Margin: " + imgMargin + "\n" +
                        "Border: " + imgBorder + "\n" +
                        "Alt Text: " + imgAltText + "\n";

      $(".lens").html(htmlForTextWithEmbeddedNewlines(lensImgText));

    });

    //get the CSS properties of the paragraph to be displayed in the lens
    $('p').mouseover(function(e) {

      var paraWidth = $(e.target).width()
      $('#paraWidth').val(paraWidth);
      var paraHeight = $(e.target).height()
      $('#paraHeight').val(paraHeight);
      var paraPosition = $(e.target).position();
      var paraX = paraPosition.left;
      $('#paraX').val(paraX);
      var paraY =  Math.round(paraPosition.top);
      $('#paraY').val(paraY);
      var stringLength = $(e.target).text().length;
      $('#stringLength').val(stringLength);
      var wordCount = $(e.target).text().split(/\s+/).length;
      $('#wordCount').val(wordCount);

      var lensParaText = "Width: " + paraWidth + "\n" + 
                         "Height: " + paraHeight + "\n" + 
                         "X Position: " + paraX + "\n" + 
                         "Y Position: " + paraY + "\n" +
                         "Character Count: " + stringLength + "\n" +
                         "Word Count: " + wordCount + "\n";

      $(".lens").html(htmlForTextWithEmbeddedNewlines(lensParaText));

    });
    
    //get the CSS properties of the table to be displayed in the lens
    $('table').mouseover(function(e) {

      $(e.target).attr('id', 'thisTable');

      var tableWidth = $(e.target).width()
      $('#tableWidth').val(tableWidth);
      var tableHeight = $(e.target).height()
      $('#tableHeight').val(tableHeight);
      var tablePosition = $(e.target).position();
      var tableX = tablePosition.left;
      $('#tableX').val(tableX);
      var tableY = Math.round(tablePosition.top);
      $('#tableY').val(tableY);
      var numCells = $("#thisTable > tbody > tr > td").length;
      $('#numCells').val(numCells);
      var numRows = $("#thisTable > tbody > tr").length;
      $('#numRows').val(numRows);
      var numColumns = $("#thisTable > tbody > tr > td").length;
      $('#numColumns').val(numColumns/numRows);
      var tableZIndex = $(e.target).css('z-index');
      $('#tableZIndex').val(tableZIndex);
      var tableMargin = $(e.target).css('margin');
      $('#tableMargin').val(tableMargin);
      var tableBorder = $(e.target).css('border');
      $('#tableBorder').val(tableBorder);

      var lensTableText = "Width: " + tableWidth + "\n" + 
                          "Height: " + tableHeight + "\n" + 
                          "X Position: " + tableX + "\n" + 
                          "Y Position: " + tableY + "\n" +
                          "Number of Cells: " + numCells + "\n" +
                          "Number of Rows: " + numRows + "\n" +
                          "Number of Columns: " + numColumns/numRows + "\n" +
                          "Z Index: " + tableZIndex + "\n" +
                          "Margin: " + tableMargin + "\n" +
                          "Border: " + tableBorder + "\n";

      $(".lens").html(htmlForTextWithEmbeddedNewlines(lensTableText));

    });

    // code to drag the lens around with the mouse
    $('.lens').mousemove(function(e){

      var lensPositionX = e.pageX - 125;
      var lensPositionY = e.pageY - 100;

      $('.lens').css({top: lensPositionY, left: lensPositionX});

    });

    $(function(){
      
    });

  });
</script>